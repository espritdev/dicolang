{% extends "base.html" %}

{% block extra_css %}
<style>
    .history-container {
        max-width: 800px;
        margin: 2rem auto;
        padding: 0 1rem;
    }

    .history-table {
        background: var(--card-bg);
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .history-table th {
        background-color: var(--primary-light);
        color: var(--text-light);
        font-weight: 500;
        text-transform: uppercase;
        font-size: 0.9rem;
    }

    .history-table td {
        vertical-align: middle;
    }

    .history-table tr:hover {
        background-color: rgba(255, 255, 255, 0.05);
    }

    .search-word {
        color: var(--primary-light);
        font-weight: 500;
        cursor: pointer;
        text-decoration: none;
    }

    .search-word:hover {
        color: var(--primary-light);
        text-decoration: underline;
    }

    .lang-badge {
        background-color: var(--primary-light);
        color: var(--text-light);
        padding: 0.25rem 0.75rem;
        border-radius: 20px;
        font-size: 0.8rem;
    }

    .empty-history {
        text-align: center;
        padding: 3rem;
        color: var(--text-color);
    }

    .empty-history i {
        font-size: 3rem;
        color: var(--primary-light);
        margin-bottom: 1rem;
    }
</style>
{% endblock %}

{% block title %}Historique - Dico'Lang{% endblock %}

{% block content %}
<div class="history-container">
    <h2 class="mb-4"><i class="fas fa-history"></i> Historique des recherches</h2>
    
    {% if history %}
    <div class="table-responsive history-table">
        <table class="table table-borderless mb-0">
            <thead>
                <tr>
                    <th>Mot</th>
                    <th>Langue</th>
                    <th>Date</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                {% for id, word, lang, timestamp in history %}
                <tr>
                    <td>
                        <a href="javascript:void(0)" onclick="searchWord('{{ word }}', '{{ lang }}')" class="search-word">
                            {{ word }}
                        </a>
                    </td>
                    <td><span class="lang-badge">{{ lang }}</span></td>
                    <td>{{ timestamp }}</td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary" onclick="copyToClipboard('{{ word }}')">
                            <i class="fas fa-copy"></i>
                        </button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="empty-history">
        <i class="fas fa-search"></i>
        <h3>Aucune recherche pour le moment</h3>
        <p>Vos recherches apparaîtront ici</p>
    </div>
    {% endif %}
</div>
{% endblock %}

{% block extra_js %}
<script>
function searchWord(word, lang) {
    window.location.href = `/?word=${encodeURIComponent(word)}&lang=${encodeURIComponent(lang)}`;
}

function copyToClipboard(text) {
    navigator.clipboard.writeText(text).then(() => {
        // Vous pouvez ajouter une notification ici si vous le souhaitez
        alert('Mot copié !');
    }).catch(err => {
        console.error('Erreur lors de la copie :', err);
    });
}
</script>
{% endblock %}
